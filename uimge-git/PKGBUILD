# Contributor: Apkawa <apkawa@gmail.com>

pkgname=uimge-git
pkgver=20090627
pkgrel=1
pkgdesc="Python picture uploader to different imagehostings"
arch=('i686' 'x86_64')
url="http://code.google.com/p/uimge/"
license=('GPL')
makedepends=('git')
depends=('python')
optdepends=('pygtk gtk: for guimge - multiuploading files gui based on gtk')
provides=('uimge' 'uimge-svn')
conflicts=('uimge' 'uimge-svn')
replaces=('uimge' 'uimge-svn')
source=( )
md5sums=( )

_gitname="uimge"
_gitroot="git://github.com/Apkawa/uimge.git"
build() {
  cd ${srcdir}
  msg "Connecting to $_gitroot GIT server...."

  if [ -d ${srcdir}/$_gitname ] ; then
  cd $_gitname && git pull origin
  msg "The local files are updated."
  else
  git clone $_gitroot
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  cp -r ${srcdir}/${_gitname} ${srcdir}/${_gitname}-build
  cd ${srcdir}/${_gitname}-build/uimgepy


  python setup.py build -f install -f --root $startdir/pkg --prefix=/usr || return 1

  mkdir $startdir/pkg/usr/bin

  ln -s /usr/lib/python2.6/site-packages/uimge/uimge.py $startdir/pkg/usr/bin/uimge
  chmod +x $startdir/pkg/usr/lib/python2.6/site-packages/uimge/uimge.py
#install guimge gui
  cd ${srcdir}/${_gitname}-build/guimge
  mkdir $startdir/pkg/usr/share/guimge -p
  cp guimge.glade $startdir/pkg/usr/share/guimge/
  install -Dm755 guimge.py $startdir/pkg/usr/bin/guimge
  #install -Dm755 $startdir/pkg/usr/bin/guimge.py $startdir/pkg/usr/bin/guimge
  #rm $startdir/pkg/usr/bin/uimge.py
}
